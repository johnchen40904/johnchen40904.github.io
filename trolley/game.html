<!DOCTYPE html>
<html>

<head>
    <title>Trolley Problems</title>
    <style>
        .game-container {
            width: 840px;
            height: 560px;
            position: relative;
            margin: auto;
            background-image: url("rail.png");
            background-size: cover;
        }

        #rectangle {
            width: 300px;
            height: 300px;
            position: relative;
            left: 30px;
            top: -30px;
            background-image: url('trolley.png');
            background-size: cover;
            //background-color: red;
            offset: path("M90,153 C575,341 575,341 748,360");
        }

        #man {
            width: 100px;
            height: 120px;
            background-image: url('man.png');
            background-size: cover;
            //background-color: blue;
            position: absolute;
            top: 20px;
            right: 300px;
        }

        #stick {
            width: 40px;
            height: 70px;
            background-image: url('stick.png');
            background-size: cover;
            //background-color: green;
            position: absolute;
            top: 75px;
            right: 385px;
        }

        .timer {
            font-size: 36px;
            font-weight: bold;
            position: absolute;
            top: 10px;
            right: 10px;
        }

        .score-counter {
            font-size: 36px;
            font-weight: bold;
            position: absolute;
            top: 50px;
            right: 10px;
        }

        button {
            font-size: 18px;
            padding: 10px 20px;
            margin: 10px;
        }

        #left-button {
            position: absolute;
            left: 10px;
            bottom: 10px;
        }

        #right-button {
            position: absolute;
            right: 10px;
            bottom: 10px;
        }

        #rectangle.curve-animation {
            offset-path: path("M90,153 C575,341 375,90 757,206");
            animation: curve-movement 3s;
        }

        #rectangle.straight-animation {
            offset-path: path("M90,153 C575,341 575,341 748,400");
            animation: straight-movement 3s;
        }

        @keyframes curve-movement {
            0% {
                offset-distance: 0%;
            }

            100% {
                offset-distance: 100%;
            }
        }

        @keyframes straight-movement {
            0% {
                offset-distance: 0%;
            }

            100% {
                offset-distance: 100%;
            }
        }

    </style>

</head>

<body>
    <div class="game-container">
        <div id="man"></div>
        <div id="stick"></div>
        <div id="rectangle"></div>
        <button id="left-button">Push the Lever</button>
        <button id="right-button">Do Nothing</button>
    </div>
    <div class="timer">10</div>
    <div class="score-counter">0</div>

    <script>
        let rectangle = document.getElementById("rectangle");
        let leftButton = document.getElementById("left-button");
        let rightButton = document.getElementById("right-button");
        let timer = document.querySelector(".timer");
        let scoreCounter = document.querySelector(".score-counter");
        let stick = document.getElementById("stick");

        let score = 0;
        let timerCount = 10;
        let buttonDisabled = false;

        let a_score = 1;
        let b_score = 5;

        leftButton.addEventListener("click", function() {
            if (buttonDisabled) {
                return;
            }
            buttonDisabled = true;
            setTimeout(function() {
                buttonDisabled = false;
            }, 3000);

            stick.style.transform = "scaleX(-1)";
            rectangle.classList.add("curve-animation");
            let r_reset = setTimeout(function() {
                rectangle.classList.remove("curve-animation");
                stick.classList.remove("flip");
                stick.style.transform = "scaleX(1)";

            }, 3000);

            timerCount = 11;
            score += a_score;
            scoreCounter.innerHTML = score;
        });

        rightButton.addEventListener("click", function() {
            if (buttonDisabled) {
                return;
            }
            buttonDisabled = true;
            setTimeout(function() {
                buttonDisabled = false;
            }, 3000);

            rectangle.classList.add("straight-animation");
            let r_reset = setInterval(function() {
                rectangle.classList.remove("straight-animation");
                clearInterval(r_reset);
            }, 3000);

            timerCount = 11;
            score += b_score;
            scoreCounter.innerHTML = score;
        });

        let countdown = setInterval(function() {
            timerCount--;
            timer.innerHTML = timerCount;
            if (timerCount <= 0) {
                clearInterval(countdown);
                //alert("Time's up!");
            }
        }, 1000);

    </script>
</body>

</html>
